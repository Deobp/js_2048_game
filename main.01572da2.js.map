{"version":3,"sources":["scripts/main.js"],"names":["initialField","upDatefield","scoreNumber","cells","document","getElementsByClassName","scoreText","buttonStart","querySelector","startText","lose","gameStarted","initial","arr","i","length","innerHTML","slide","field","direction","tempField","rows","push","slice","JSON","map","item","index","horizontal","reverse","concat","stringify","row","tempRow","removeZero","fillArrayWithZero","vertical","dir","columns","Array","from","_","colIndex","filter","__","rowIndex","numCols","transposedArray","j","res","replaceRandomZero","array","zeroIndices","reduce","indices","value","partCondition","randomIndex","Math","floor","random","replacementValue","checker","original","left","right","down","up","includes","style","display","styleCells","className","classList","add","addEventListener","originalUpDatefield","event","key"],"mappings":";AAAA,aAqNC,SAAA,EAAA,GAAA,OAAA,EAAA,IAAA,EAAA,IAAA,EAAA,IAAA,IAAA,SAAA,IAAA,MAAA,IAAA,UAAA,wIAAA,SAAA,EAAA,EAAA,GAAA,GAAA,EAAA,CAAA,GAAA,iBAAA,EAAA,OAAA,EAAA,EAAA,GAAA,IAAA,EAAA,OAAA,UAAA,SAAA,KAAA,GAAA,MAAA,GAAA,GAAA,MAAA,WAAA,GAAA,EAAA,cAAA,EAAA,EAAA,YAAA,MAAA,QAAA,GAAA,QAAA,EAAA,MAAA,KAAA,GAAA,cAAA,GAAA,2CAAA,KAAA,GAAA,EAAA,EAAA,QAAA,GAAA,SAAA,EAAA,GAAA,GAAA,oBAAA,QAAA,MAAA,EAAA,OAAA,WAAA,MAAA,EAAA,cAAA,OAAA,MAAA,KAAA,GAAA,SAAA,EAAA,GAAA,GAAA,MAAA,QAAA,GAAA,OAAA,EAAA,GAAA,SAAA,EAAA,EAAA,IAAA,MAAA,GAAA,EAAA,EAAA,UAAA,EAAA,EAAA,QAAA,IAAA,IAAA,EAAA,EAAA,EAAA,IAAA,MAAA,GAAA,EAAA,EAAA,IAAA,EAAA,GAAA,EAAA,GAAA,OAAA,EAnND,IAAMA,EAAe,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GAC/DC,EAAcD,EACdE,EAAc,EACZC,EAAQC,SAASC,uBAAuB,cACxCC,EAAYF,SAASC,uBAAuB,cAC5CE,EAAcH,SAASI,cAAc,UACrCC,EAAYL,SAASC,uBAAuB,iBAC5CK,EAAON,SAASC,uBAAuB,gBAAgB,GAEzDM,GAAc,EAmDlB,SAASC,EAAQC,GACV,IAAA,IAAIC,EAAI,EAAGA,EAAIX,EAAMY,OAAQD,IAChCX,EAAMW,GAAGE,UAAYH,EAAIC,GAAK,EAAID,EAAIC,GAAK,GAI/C,SAASG,EAAMC,EAAOC,GAIf,IAJ0B,IAAA,EAC3BC,EAAgBF,EAAAA,GACdG,EAAO,GAEJP,EAAI,EAAGA,EAAIM,EAAUL,OAAQD,GAAK,EACzCO,EAAKC,KAAKF,EAAUG,MAAMT,EAAGA,EAAI,IAa/BU,OAVJH,EAAKI,IAAI,SAACC,EAAMC,GACI,SAAdR,EACFE,EAAKM,GAASC,EAAWF,EAAM,QACR,UAAdP,IACTE,EAAKM,GAASC,EAAWF,EAAKG,UAAW,YAI7CT,GAAeU,EAAAA,IAAAA,OAAUT,MAAAA,EAAAA,GAErBG,KAAKO,UAAU9B,KAAiBuB,KAAKO,UAAUX,GAC1CnB,GAGTA,EAAcmB,EACdd,EAAU,GAAGU,UAAYd,EAGlBD,GAGT,SAAS2B,EAAWI,EAAKb,GAGlB,IAFDc,IAAAA,EAAUC,EAAWF,GAEhBlB,EAAI,EAAGA,EAAImB,EAAQlB,OAAS,EAAGD,IAClCmB,GAAAA,EAAQnB,EAAI,KAAOmB,EAAQnB,GAAI,CACF,IAAA,EAAA,CAAc,EAAbmB,EAAQnB,GAAQ,GAA/CmB,EAAQnB,GADwB,EAAA,GACpBmB,EAAQnB,EAAI,GADQ,EAAA,GAEjCZ,GAAe+B,EAAQnB,GAUpBK,OAFPc,EAAUE,EAHVF,EAAUC,EAAWD,IAKA,SAAdd,EAAuBc,EAAUA,EAAQJ,UAGlD,SAASO,EAASvB,EAAKwB,GAAK,IAAA,EACtBC,EAAUC,MAAMC,KAAK,CAAEzB,OAAQ,GAAK,SAAC0B,EAAGC,GAC1C7B,OAAAA,EAAI8B,OAAO,SAACC,EAAIC,GAAaA,OAAAA,EAAW,IAAMH,MAGhDJ,GAAaR,EAAAA,IAAAA,OAAUQ,MAAAA,EAAAA,EAAAA,IAEX,OAARD,EACFC,EAAUrB,EAAMqB,EAAS,QACR,SAARD,IACTC,EAAUrB,EAAMqB,EAAS,UAMtB,IAHCQ,IAAAA,EAAUR,EAAQvB,OAAS,EAC3BgC,EAAkB,GAEfjC,EAAI,EAAGA,EAAI,EAAGA,IAChB,IAAA,IAAIkC,EAAI,EAAGA,EAAIF,EAASE,IAC3BD,EAAgBzB,KAAKgB,EAAQxB,EAAQ,EAAJkC,IAO9B/C,OAHPA,EAAc8C,EACdzC,EAAU,GAAGU,UAAYd,EAElBD,EAIT,SAASiC,EAAWF,GACXA,OAAAA,EAAIW,OAAO,SAACjB,GAASA,OAAAA,EAAO,IAGrC,SAASS,EAAkBtB,GACrBoC,IAAAA,EAAMpC,EAKHoC,OAHPA,EAAIlC,OAAS,EACbkC,EAAMV,MAAMC,KAAKS,EAAK,SAACvB,GAAUA,OAAAA,GAAQ,IAK3C,SAASwB,EAAkBC,GACnBC,IAAAA,EAAcD,EAAME,OAAO,SAACC,EAASC,EAAO5B,GAKzC2B,OAJO,IAAVC,GACFD,EAAQhC,KAAKK,GAGR2B,GACN,IAECF,GAAuB,IAAvBA,EAAYrC,OACPoC,OAAAA,EAGHK,IACAC,EAAcL,EADEM,KAAKC,MAAMD,KAAKE,SAAWR,EAAYrC,SAGvD8C,EAAmBH,KAAKE,SAAW,GAAM,EAAI,EAE5CT,OAAAA,EAAM1B,IAAI,SAAC8B,EAAO5B,GACfA,OAAAA,IAAU8B,EAAcI,EAAmBN,IAIvD,SAASO,IACDC,IAAAA,EAAe9D,EAAAA,GACf+D,EAAO/C,EAAM8C,EAAU,QACvBE,EAAQhD,EAAM8C,EAAU,SACxBG,EAAO9B,EAAS2B,EAAU,QAC1BI,EAAK/B,EAAS2B,EAAU,MAE1B9D,GAAAA,EAAYmE,SAAS,MACXhE,SAASC,uBAAuB,eAAe,GAEvDgE,MAAMC,QAAU,aACf,GACL9C,KAAKO,UAAUgC,KAAcvC,KAAKO,UAAUiC,IACzCxC,KAAKO,UAAUgC,KAAcvC,KAAKO,UAAUkC,IAC5CzC,KAAKO,UAAUgC,KAAcvC,KAAKO,UAAUmC,IAC5C1C,KAAKO,UAAUgC,KAAcvC,KAAKO,UAAUoC,GAKxC,OAHPlE,EAAc8D,EACdrD,EAAK2D,MAAMC,QAAU,SAEd,EAIF,OAFPrE,EAAc8D,GAEP,EAGT,SAASQ,IACF,IAAA,IAAIzD,EAAI,EAAGA,EAAIX,EAAMY,OAAQD,IAChCX,EAAMW,GAAG0D,UAAa,aACtBrE,EAAMW,GAAG2D,UAAUC,IAAmBvE,eAAAA,OAAAA,EAAMW,GAAGE,YAtMnDT,EAAYoE,iBAAiB,QAAS,WACpChE,GAAc,EACdT,EAAc,EACdI,EAAU,GAAGU,UAAYd,EACzBD,EAAciD,EAAkBlD,GAChCC,EAAciD,EAAkBjD,GAChCS,EAAK2D,MAAMC,QAAU,OACrB1D,EAAQX,GACRsE,IACA9D,EAAU,GAAG4D,MAAMC,QAAU,OAC7B/D,EAAYkE,UAAUC,IAAI,WAC1BnE,EAAYS,UAAY,YAG1BZ,SAASuE,iBAAiB,UAAW,WAC/BhE,GAAAA,EAAa,CACTiE,IAAAA,EAA0B3E,EAAAA,GAExB4E,OAAAA,MAAMC,KACP,IAAA,YACH7E,EAAcgB,EAAMhB,EAAa,QAEjC,MAEG,IAAA,aACHA,EAAcgB,EAAMhB,EAAc,SAElC,MAEG,IAAA,UACHA,EAAcmC,EAASnC,EAAa,MACpC,MAEG,IAAA,YACHA,EAAcmC,EAASnC,EAAa,QAMpCuB,KAAKO,UAAU9B,KAAiBuB,KAAKO,UAAU6C,KAEjDhE,EADAX,EAAciD,EAAkBjD,IAEhCsE,KAEFT","file":"main.01572da2.js","sourceRoot":"../src","sourcesContent":["'use strict';\n\nconst initialField = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];\nlet upDatefield = initialField;\nlet scoreNumber = 0;\nconst cells = document.getElementsByClassName('field-cell');\nconst scoreText = document.getElementsByClassName('game-score');\nconst buttonStart = document.querySelector('button');\nconst startText = document.getElementsByClassName('message-start');\nconst lose = document.getElementsByClassName('message-lose')[0];\n\nlet gameStarted = false;\n\nbuttonStart.addEventListener('click', () => {\n  gameStarted = true;\n  scoreNumber = 0;\n  scoreText[0].innerHTML = scoreNumber;\n  upDatefield = replaceRandomZero(initialField);\n  upDatefield = replaceRandomZero(upDatefield);\n  lose.style.display = 'none';\n  initial(upDatefield);\n  styleCells();\n  startText[0].style.display = 'none';\n  buttonStart.classList.add('restart');\n  buttonStart.innerHTML = 'restart';\n});\n\ndocument.addEventListener('keydown', function() {\n  if (gameStarted) {\n    const originalUpDatefield = [...upDatefield];\n\n    switch (event.key) {\n      case 'ArrowLeft':\n        upDatefield = slide(upDatefield, 'left');\n\n        break;\n\n      case 'ArrowRight':\n        upDatefield = slide(upDatefield, ('right'));\n\n        break;\n\n      case 'ArrowUp':\n        upDatefield = vertical(upDatefield, 'up');\n        break;\n\n      case 'ArrowDown':\n        upDatefield = vertical(upDatefield, 'down');\n        break;\n\n      default:\n    }\n\n    if (JSON.stringify(upDatefield) !== JSON.stringify(originalUpDatefield)) {\n      upDatefield = replaceRandomZero(upDatefield);\n      initial(upDatefield);\n      styleCells();\n    }\n    checker();\n  }\n});\n\nfunction initial(arr) {\n  for (let i = 0; i < cells.length; i++) {\n    cells[i].innerHTML = arr[i] > 0 ? arr[i] : '';\n  }\n}\n\nfunction slide(field, direction) {\n  let tempField = [...field];\n  const rows = [];\n\n  for (let i = 0; i < tempField.length; i += 4) {\n    rows.push(tempField.slice(i, i + 4));\n  }\n\n  rows.map((item, index) => {\n    if (direction === 'left') {\n      rows[index] = horizontal(item, 'left');\n    } else if (direction === 'right') {\n      rows[index] = horizontal(item.reverse(), 'right');\n    }\n  });\n\n  tempField = [].concat(...rows);\n\n  if (JSON.stringify(upDatefield) === JSON.stringify(tempField)) {\n    return upDatefield;\n  }\n\n  upDatefield = tempField;\n  scoreText[0].innerHTML = scoreNumber;\n  // checker();\n\n  return upDatefield;\n}\n\nfunction horizontal(row, direction) {\n  let tempRow = removeZero(row);\n\n  for (let i = 0; i < tempRow.length - 1; i++) {\n    if (tempRow[i + 1] === tempRow[i]) {\n      [tempRow[i], tempRow[i + 1]] = [tempRow[i] * 2, 0];\n      scoreNumber += tempRow[i];\n    }\n  }\n\n  // Remove 0's\n  tempRow = removeZero(tempRow);\n\n  // Fill 0's\n  tempRow = fillArrayWithZero(tempRow);\n\n  return direction === 'left' ? tempRow : tempRow.reverse();\n}\n\nfunction vertical(arr, dir) {\n  let columns = Array.from({ length: 4 }, (_, colIndex) =>\n    arr.filter((__, rowIndex) => rowIndex % 4 === colIndex),\n  );\n\n  columns = [].concat(...columns);\n\n  if (dir === 'up') {\n    columns = slide(columns, 'left');\n  } else if (dir === 'down') {\n    columns = slide(columns, 'right');\n  }\n\n  const numCols = columns.length / 4;\n  const transposedArray = [];\n\n  for (let i = 0; i < 4; i++) {\n    for (let j = 0; j < numCols; j++) {\n      transposedArray.push(columns[i + j * 4]);\n    }\n  }\n\n  upDatefield = transposedArray;\n  scoreText[0].innerHTML = scoreNumber;\n\n  return upDatefield;\n}\n\n// manipulate with row\nfunction removeZero(row) {\n  return row.filter((item) => item > 0);\n}\n\nfunction fillArrayWithZero(arr) {\n  let res = arr;\n\n  res.length = 4;\n  res = Array.from(res, (item) => (item || 0));\n\n  return res;\n}\n\nfunction replaceRandomZero(array) {\n  const zeroIndices = array.reduce((indices, value, index) => {\n    if (value === 0) {\n      indices.push(index);\n    }\n\n    return indices;\n  }, []);\n\n  if (zeroIndices.length === 0) {\n    return array;\n  }\n\n  const partCondition = Math.floor(Math.random() * zeroIndices.length);\n  const randomIndex = zeroIndices[partCondition];\n\n  const replacementValue = Math.random() < 0.9 ? 2 : 4;\n\n  return array.map((value, index) => {\n    return (index === randomIndex ? replacementValue : value);\n  });\n}\n\nfunction checker() {\n  const original = [...upDatefield];\n  const left = slide(original, 'left');\n  const right = slide(original, 'right');\n  const down = vertical(original, 'down');\n  const up = vertical(original, 'up');\n\n  if (upDatefield.includes(2048)) {\n    const win = document.getElementsByClassName('message-win')[0];\n\n    win.style.display = 'block';\n  } else if (\n    JSON.stringify(original) === JSON.stringify(left)\n    && JSON.stringify(original) === JSON.stringify(right)\n    && JSON.stringify(original) === JSON.stringify(down)\n    && JSON.stringify(original) === JSON.stringify(up)\n  ) {\n    upDatefield = original;\n    lose.style.display = 'block';\n\n    return true;\n  }\n  upDatefield = original;\n\n  return false;\n}\n\nfunction styleCells() {\n  for (let i = 0; i < cells.length; i++) {\n    cells[i].className = ('field-cell');\n    cells[i].classList.add(`field-cell--${cells[i].innerHTML}`);\n  }\n}\n"]}